

<body>

  <div class="container">
    <h2><img class="titleimg"
        src="https://www.nicepng.com/png/detail/242-2420369_atencion-al-cliente-png-imagenes-de-actividades-claves.png">
      Panel de Estado de Atenciones</h2>


    <div class="barradebusqueda">
      <mat-form-field class="filter"
        appearance="standard">
        <mat-label>Buscar..</mat-label>
        <input matInput (keyup)="applyFilter($event)" placeholder="Nombre de
          ...." #input />
      </mat-form-field>

      <!--Select-->
      <mat-form-field class="buscador">
        <mat-label>Estado</mat-label>
        <mat-select [(ngModel)]="opcion">
          <mat-option value="Sin Asignar" (click)="buscar()">Sin Asignar</mat-option>
          <mat-option value="En Proceso" (click)="buscar()">Asignado</mat-option>
          <mat-option value="Finalizado" (click)="buscar()">Finalizado</mat-option>
          <mat-option value="Derivado" (click)="buscar()">Nesecita Ayuda
            Especial</mat-option>
        </mat-select>
      </mat-form-field>

    </div>



    <!-- Tabla pacientes sin asignar-->
    <div>
      <div class="mat-elevation-z8">
        <table mat-table multiTemplateDataRows matSort #TableOneSort="matSort"
          [dataSource]="dataSource">

          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef>Nombre Completo</th>
            <td mat-cell *matCellDef="let element"> {{(element.nombre + ' ' +
              element.apellido) | titlecase}} </td>
          </ng-container>
          <ng-container matColumnDef="motivo">
            <th mat-header-cell *matHeaderCellDef>Motivo</th>
            <td mat-cell *matCellDef="let element"> {{element.motivo |
              titlecase}}
            </td>
          </ng-container>
          <ng-container matColumnDef="genero">
            <th mat-header-cell *matHeaderCellDef>Genero</th>
            <td mat-cell *matCellDef="let element"> {{element.genero == 'H' ?
              'Hombre' : 'Mujer' }}
            </td>
          </ng-container>
          <ng-container matColumnDef="telefono">
            <th mat-header-cell *matHeaderCellDef>Telefono/Celular</th>
            <td mat-cell *matCellDef="let element"> {{element.telefono}} </td>
          </ng-container>
          <ng-container matColumnDef="estado">
            <th mat-header-cell *matHeaderCellDef>Estado</th>
            <td mat-cell *matCellDef="let element"> {{element.estado}} </td>
          </ng-container>
          <ng-container matColumnDef="asignacion" *ngIf="opcion=='Sin Asignar'">
            <th mat-header-cell *matHeaderCellDef>Asignar Especialista</th>
            <td mat-cell class="imgasignar" *matCellDef="let element"> <img
                src="https://img.icons8.com/color/30/000000/scale-tool.png"
                (click)="seleccionarpac(element)" style="cursor: pointer;"
                data-toggle="modal"
                data-target="#exampleModalCenter" /> </td>
          </ng-container>
          <ng-container matColumnDef="asignacion" *ngIf="opcion=='En Proceso'">
            <th mat-header-cell *matHeaderCellDef>Psicologo Seleccionado</th>
            <td mat-cell class="imgasignar" *matCellDef="let element"> <img
                src="https://cdn-icons-png.flaticon.com/512/3534/3534606.png"
                style="cursor: pointer;width: 30px;height: 30px;margin-left:
                20px;"
                (click)="verasignacion(element.idpaciente)"
                data-toggle="modal"
                data-target="#detallepsi" /> </td>
          </ng-container>
          <ng-container matColumnDef="asignacion" *ngIf="opcion=='Finalizado'">
            <th mat-header-cell *matHeaderCellDef>Ver detalle</th>
            <td mat-cell class="imgasignar" *matCellDef="let element"> <img
                src="https://www.pngitem.com/pimgs/m/34-341449_transparent-tumblr-clipart-eye-png-png-download.png"
                style="cursor: pointer;width: 30px;height: 30px;margin-left:
                20px;"
                (click)="verultimaobser(element.idpaciente)"
                data-toggle="modal"
                data-target="#detalleultimo" /> </td>
          </ng-container>
          <ng-container matColumnDef="asignacion" *ngIf="opcion=='Derivado'">
            <th mat-header-cell *matHeaderCellDef>Ver detalle</th>
            <td mat-cell class="imgasignar" *matCellDef="let element"> <img
                src="https://www.pngitem.com/pimgs/m/34-341449_transparent-tumblr-clipart-eye-png-png-download.png"
                style="cursor: pointer;width: 30px;height: 30px;margin-right:
                30px;"
                (click)="verultimaobser(element.idpaciente)"
                data-toggle="modal"
                data-target="#detalleultimo" /><img
                src="https://img.icons8.com/color/30/000000/scale-tool.png"
                (click)="seleccionarpac(element)" style="cursor: pointer;"
                data-toggle="modal"
                data-target="#exampleModalCenter" /> </td>
          </ng-container>
          <ng-container matColumnDef="expandedDetail">
            <td mat-cell *matCellDef="let element"
              [attr.colspan]="columnsToDisplay.length">
              <div class="example-element-detail"
                [@detailExpand]="element == expandedElement ? 'expanded' :
                'collapsed'">
                <div class="example-element-description">
                  <label>Descripcion:</label>
                  {{element.descripcion}}

                </div>
              </div>
            </td>
          </ng-container>

          <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
          <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>

          <tr mat-row *matRowDef="let element; columns: columnsToDisplay;"
            class="example-element-row"
            [class.example-expanded-row]="expandedElement === element"
            (click)="expandedElement= expandedElement === element ? null :
            element">
          </tr>
          <tr mat-row *matRowDef="let row; columns: ['expandedDetail']"
            class="example-detail-row"></tr>
        </table>



        <!-- Tabla pacientes Finalizados/Asignados-->
        <!-- <table mat-table multiTemplateDataRows matSort #TableTwoSort="matSort" *ngIf="opcion=='Finalizado' || opcion == 'En Proceso'"
        
          [dataSource]="dataSource2">
        
          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef>Nombre Completo</th>
            <td mat-cell *matCellDef="let element"> {{(element.nombre + ' ' +
              element.apellido) | titlecase}} </td>
          </ng-container>
          <ng-container matColumnDef="motivo">
            <th mat-header-cell *matHeaderCellDef>Motivo</th>
            <td mat-cell *matCellDef="let element"> {{element.motivo |
              titlecase}}
            </td>
          </ng-container>
          <ng-container matColumnDef="telefono">
            <th mat-header-cell *matHeaderCellDef>Telefono/Celular</th>
            <td mat-cell *matCellDef="let element"> {{element.telefono}} </td>
          </ng-container>
          <ng-container matColumnDef="estado">
            <th mat-header-cell *matHeaderCellDef>Estado</th>
            <td mat-cell *matCellDef="let element"> {{element.estado}} </td>
          </ng-container>
          <ng-container matColumnDef="detalle">
            <th mat-header-cell *matHeaderCellDef>Psicologo Seleccionado</th>
            <td mat-cell class="imgasignar" *matCellDef="let element" > <img
                src="https://cdn-icons-png.flaticon.com/512/3534/3534606.png"
                style="cursor: pointer;width: 30px;height: 30px;margin-left: 20px;"
                data-toggle="modal"
                data-target="#detallepsi" /> </td>
          </ng-container>

          <ng-container matColumnDef="expandedDetail">
            <td mat-cell *matCellDef="let element"
              [attr.colspan]="columnsToDisplay2.length">
              <div class="example-element-detail"
                [@detailExpand]="element == expandedElement2 ? 'expanded' :
                'collapsed'">
                <div class="example-element-description">
                  <label>Descripcion:</label>
                  {{element.descripcion}}

                </div>
              </div>
            </td>
          </ng-container>

           Expanded Content Column - The detail row is made up of this one column that spans across all columns 
          <tr mat-header-row *matHeaderRowDef="columnsToDisplay2"></tr>

          <tr mat-row *matRowDef="let element; columns: columnsToDisplay2;"
            class="example-element-row"
            [class.example-expanded-row]="expandedElement2 === element"
            (click)="expandedElement2= expandedElement2 === element ? null :
            element">
          </tr>
          <tr mat-row *matRowDef="let row; columns: ['expandedDetail']"
            class="example-detail-row"></tr>

        </table> -->
        <mat-paginator #MatPaginator1="matPaginator" [pageSize]="5"
          [pageSizeOptions]="[3, 5]"
          showFirstLastButtons>
        </mat-paginator>




      </div>











    </div>


  </div>











</body>
<!-- Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
  aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle" style="text-align:
          center; color:rgb(58, 69, 221)">Â¿A QUE ESPECIALISTA DESEA DERIVAR?</h5>
        <button type="button" class="close" data-dismiss="modal"
          aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div>
          <a href="" [routerLink]="['/nav/psicologo',pacseleccionado]"
            (click)="cerrarModal()"><img
              src="https://img.icons8.com/color/48/000000/psychology.png" /></a>
          <p>Psicologo</p>
        </div>
        <div>
          <a href="" [routerLink]="['/nav/pastor',pacseleccionado]"
            (click)="cerrarModal()"><img
              src="https://img.icons8.com/color/48/000000/the-pope.png" /></a>
          <p>Pastor</p>
        </div>
        <div>
          <a href="" [routerLink]="['/nav/estudiante',pacseleccionado]"
            (click)="cerrarModal()"><img
              src="https://img.icons8.com/color/48/000000/student-male--v1.png"
              /></a>
          <p>Estudiante</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Psicologo detalle-->
<div class="modal fade bd-example-modal-lg" id="detallepsi" tabindex="-1"
  role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header" style="background-color: currentColor;">
        <h5 class="modal-title" id="exampleModalLongTitle"
          style="color:white;">Datos
          de Especialista Asignado</h5>
        <button type="button" class="close" data-dismiss="modal"
          aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body detailbody">

        <div class="detailrigth">
          <h4 style="text-align: center;font-weight: bold;color:
            #c5c5c5;text-transform: capitalize;">
            <img style="width: 30px;height: 30px;"
              *ngIf="psi_asig.tipo=='psicologo'"
              src="https://img.icons8.com/color/48/000000/psychology.png" />
            <img style="width: 30px;height: 30px;"
              *ngIf="psi_asig.tipo=='pastor'"
              src="https://img.icons8.com/color/48/000000/the-pope.png" />
            <img style="width: 30px;height: 30px;"
              *ngIf="psi_asig.tipo=='estudiante'"
              src="https://img.icons8.com/color/48/000000/student-male--v1.png"
              />
            {{psi_asig.nombre + ' ' + psi_asig.apellido}}</h4>
          <div style="width: 100%;text-align: center;">

            <img [src]='imagenpsi' width="150" style="border-radius: 50%;"
              height="150" alt="">
          </div>
          <div class="group-item" *ngIf="psi_asig.tipo=='pastor'">
            <div class="item-info"><label>Telefono:</label><input disabled
                [(ngModel)]="psi_asig.telefono"></div>
            <div class="item-info"><label>Correo:</label><input disabled
                [(ngModel)]="psi_asig.correo"></div>
            <div class="item-info"><label>Especialidad:</label><input
                [(ngModel)]="psi_asig.especialidad" disabled></div>
            <div class="item-info"><label>Universidad:</label><input
                [(ngModel)]="psi_asig.universidad" disabled></div>
            <div class="item-info"><label>Grado Academico:</label><input
                [(ngModel)]="psi_asig.grado_academico" disabled></div>

          </div>
          <div *ngIf="psi_asig.tipo=='psicologo'" class="group-item">
            <div class="item-info"><label>Telefono:</label><input
                [(ngModel)]="psi_asig.telefono" disabled></div>
            <div class="item-info"><label>Correo:</label><input
                [(ngModel)]="psi_asig.correo" disabled></div>
            <div class="item-info"><label>Especialidad:</label><input
                [(ngModel)]="psi_asig.especialidad" disabled></div>
            <div class="item-info"><label>Colegiatura:</label><input
                [(ngModel)]="psi_asig.n_colegiatura" disabled></div>
            <div class="item-info"><label>Grado Academico:</label><input
                [(ngModel)]="psi_asig.grado_academico" disabled></div>

          </div>
          <div *ngIf="psi_asig.tipo=='estudiante'" class="group-item">
            <div class="item-info"><label>Telefono:</label><input
                [(ngModel)]="psi_asig.telefono" disabled></div>
            <div class="item-info"><label>Correo:</label><input
                [(ngModel)]="psi_asig.correo" disabled></div>

            <div class="item-info"><label>Ciclo/Grupo:</label><input
                [(ngModel)]="psi_asig.ciclo + '/' + psi_asig.grupo" disabled></div>
            <div class="item-info"><label>Codigo:</label><input
                [(ngModel)]="psi_asig.codigo" disabled></div>

          </div>



        </div>

      </div>
    </div>
  </div>
</div>


<!-- Modal Psicologo detalle-->
<div class="modal fade bd-example-modal-lg" id="detalleultimo" tabindex="-1"
  role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header" style="background-color: currentColor;">
        <h5 class="modal-title" id="exampleModalLongTitle"
          style="color:#c5c5c5">Datos
          de Especialista Asignado</h5>
        <button type="button" class="close" data-dismiss="modal"
          aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body detailbody">

        <div class="detailrigth">
          <h4 style="text-align: center;font-weight: bold;color:
            #c5c5c5;text-transform: capitalize;">
            <img style="width: 30px;height: 30px;"
              *ngIf="psi_asig.tipo=='psicologo'"
              src="https://img.icons8.com/color/48/000000/psychology.png" />
            <img style="width: 30px;height: 30px;"
              *ngIf="psi_asig.tipo=='pastor'"
              src="https://img.icons8.com/color/48/000000/the-pope.png" />
            <img style="width: 30px;height: 30px;"
              *ngIf="psi_asig.tipo=='estudiante'"
              src="https://img.icons8.com/color/48/000000/student-male--v1.png"
              />
            {{psi_asig.nombre + ' ' + psi_asig.apellido}}</h4>
          <div style="width: 100%;text-align: center;">

            <img [src]='imagenpsi2' width="150" style="border-radius: 50%;"
              height="150" alt="">
          </div>

          <ul class="nav nav-tabs" id="myTab" role="tablist" style="margin-top: 20px;">
            <li class="nav-item">
              <a class="nav-link active" id="home-tab" data-toggle="tab"
                href="#home" role="tab" aria-controls="home"
                aria-selected="true"><img src="assets/personal.jpg"
                  style="width: 3ox;height: 30px;margin-right: 10px;" alt="">
                Datos Personales</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="profile-tab" data-toggle="tab"
                href="#profile" role="tab" aria-controls="profile"
                aria-selected="false"><img src="assets/acedemico.jpg"
                  style="width: 3ox;height: 30px; margin-right: 10px;" alt="">Reportes de Sesiones</a>
            </li>

          </ul>






          <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active" id="home" role="tabpanel"
              aria-labelledby="home-tab">
              <div class="group-item" *ngIf="psi_asig.tipo=='pastor'">
                <div class="item-info"><label>Telefono:</label><input disabled
                    [(ngModel)]="psi_asig.telefono"></div>
                <div class="item-info"><label>Correo:</label><input disabled
                    [(ngModel)]="psi_asig.correo"></div>
                <div class="item-info"><label>Especialidad:</label><input
                    [(ngModel)]="psi_asig.especialidad" disabled></div>
                <div class="item-info"><label>Universidad:</label><input
                    [(ngModel)]="psi_asig.universidad" disabled></div>
                <div class="item-info"><label>Grado Academico:</label><input
                    [(ngModel)]="psi_asig.grado_academico" disabled></div>
              </div>


              <div *ngIf="psi_asig.tipo=='psicologo'" class="group-item">
                <div class="item-info"><label>Telefono:</label><input
                    [(ngModel)]="psi_asig.telefono" disabled></div>
                <div class="item-info"><label>Correo:</label><input
                    [(ngModel)]="psi_asig.correo" disabled></div>
                <div class="item-info"><label>Especialidad:</label><input
                    [(ngModel)]="psi_asig.especialidad" disabled></div>
                <div class="item-info"><label>Colegiatura:</label><input
                    [(ngModel)]="psi_asig.n_colegiatura" disabled></div>
                <div class="item-info"><label>Grado Academico:</label><input
                    [(ngModel)]="psi_asig.grado_academico" disabled></div>
              </div>


              <div *ngIf="psi_asig.tipo=='estudiante'" class="group-item">
                <div class="item-info"><label>Telefono:</label><input
                    [(ngModel)]="psi_asig.telefono" disabled></div>
                <div class="item-info"><label>Correo:</label><input
                    [(ngModel)]="psi_asig.correo" disabled></div>
                <div class="item-info"><label>Especialidad:</label> <input
                    [(ngModel)]="psi_asig.especialidad" disabled></div>
                <div class="item-info"><label>Ciclo/Grupo:</label><input
                    [(ngModel)]="psi_asig.ciclo + '/' + psi_asig.grupo" disabled></div>
                <div class="item-info"><label>Codigo:</label><input
                    [(ngModel)]="psi_asig.codigo" disabled></div>
              </div>

            </div>
            <div class="tab-pane fade" id="profile" role="tabpanel" style="padding: 10px;"
              aria-labelledby="profile-tab">

              <div *ngFor="let sesion of sesiones" style="width: 100%;">
                <div class="atencionesreg">
                   <label class="linea"><span>Nro Sesion: {{sesion.nro_sesion}}</span></label>
                   <div class="detalleobse">
                    <div class="detalle2">
                      <div>
                        <label for="" style="margin-right: 15px;">Condicion Final:</label>
                        <input disabled style="margin-right: 25px;"
                          [(ngModel)]="sesion.condicion">
                      </div>
                      <div>
                        <label  style="margin-right: 15px;" for="">Evidencia Final:</label>
                        <a href="sesion.evidencia">{{sesion.evidencia}}</a>
                       
                      </div>
                    </div>
                    <div class="item-info-lg">
                      <label style="color: #c5c5c5; font-weight: bold;">Observaciones:</label>
                      <textarea name="" id="" cols="90" rows="3" disabled
                        [(ngModel)]="sesion.observaciones"></textarea>
                    </div>
      
                  </div>

                </div>
                

              </div>

            </div>
          </div>


        </div>

      </div>
    </div>
  </div>
</div>